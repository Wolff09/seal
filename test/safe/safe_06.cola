
struct Node {
	data_t data;
	Node* next;
}

Node* Head;

extern void retire(Node* ptr);
extern void protect1(Node* ptr);
extern void protect2(Node* ptr);

void init() {
	Head = NULL;
}

void bar() {
	Node* head;
	atomic {
		head = Head;
	}
	atomic {
		protect1(head);
	}
	atomic {
		assert(active(head));
		assume(head == NULL);
	}
	atomic {
		assume(head == NULL);
	}
}
